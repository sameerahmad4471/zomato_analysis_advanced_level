1 : After goldusers_signup which item was purchased by each customer

select * from 
(select a.*,rank() over(partition by userid order by created_date) rnk
from 
(select s.userid,s.created_date,s.product_id ,g.gold_signup_date from sales s  join goldusers_signup
g on s.userid = g.userid and created_date >= gold_signup_date)a)b
where rnk = 1
